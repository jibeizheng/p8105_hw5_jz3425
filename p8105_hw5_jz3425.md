p8105\_hw5\_jz3425
================

## Problem 1

``` r
homicide = 
  read_csv("https://raw.githubusercontent.com/washingtonpost/data-homicides/master/homicide-data.csv")
```

Discription: The raw data contains 52179 cases of homicide in 50 large
U.S. cities over the past decades.There are 12 variables including
victim’s name, location and time of the killing and whether an arrest
was made.

Summarize within cities to obtain the total number of homicides and the
number of unsolved homicides:

``` r
homicide_df = 
  homicide %>% 
  unite("city_state", city:state)

homicide_total = 
  homicide_df %>% 
  group_by(city_state) %>% 
  summarize(total_number = n())

homicide_unsolved =
  homicide_df %>% 
  filter(disposition %in% c("Closed without arrest", "Open/No arrest")) %>% 
  group_by(city_state) %>% 
  summarize(unsolved_number = n())

homicide_summarize =
  left_join(homicide_total, homicide_unsolved, by = "city_state") %>% 
  mutate(unsolved_number = replace_na(unsolved_number, 0))
 
homicide_summarize %>% knitr::kable()
```

| city\_state        | total\_number | unsolved\_number |
|:-------------------|--------------:|-----------------:|
| Albuquerque\_NM    |           378 |              146 |
| Atlanta\_GA        |           973 |              373 |
| Baltimore\_MD      |          2827 |             1825 |
| Baton Rouge\_LA    |           424 |              196 |
| Birmingham\_AL     |           800 |              347 |
| Boston\_MA         |           614 |              310 |
| Buffalo\_NY        |           521 |              319 |
| Charlotte\_NC      |           687 |              206 |
| Chicago\_IL        |          5535 |             4073 |
| Cincinnati\_OH     |           694 |              309 |
| Columbus\_OH       |          1084 |              575 |
| Dallas\_TX         |          1567 |              754 |
| Denver\_CO         |           312 |              169 |
| Detroit\_MI        |          2519 |             1482 |
| Durham\_NC         |           276 |              101 |
| Fort Worth\_TX     |           549 |              255 |
| Fresno\_CA         |           487 |              169 |
| Houston\_TX        |          2942 |             1493 |
| Indianapolis\_IN   |          1322 |              594 |
| Jacksonville\_FL   |          1168 |              597 |
| Kansas City\_MO    |          1190 |              486 |
| Las Vegas\_NV      |          1381 |              572 |
| Long Beach\_CA     |           378 |              156 |
| Los Angeles\_CA    |          2257 |             1106 |
| Louisville\_KY     |           576 |              261 |
| Memphis\_TN        |          1514 |              483 |
| Miami\_FL          |           744 |              450 |
| Milwaukee\_wI      |          1115 |              403 |
| Minneapolis\_MN    |           366 |              187 |
| Nashville\_TN      |           767 |              278 |
| New Orleans\_LA    |          1434 |              930 |
| New York\_NY       |           627 |              243 |
| Oakland\_CA        |           947 |              508 |
| Oklahoma City\_OK  |           672 |              326 |
| Omaha\_NE          |           409 |              169 |
| Philadelphia\_PA   |          3037 |             1360 |
| Phoenix\_AZ        |           914 |              504 |
| Pittsburgh\_PA     |           631 |              337 |
| Richmond\_VA       |           429 |              113 |
| Sacramento\_CA     |           376 |              139 |
| San Antonio\_TX    |           833 |              357 |
| San Bernardino\_CA |           275 |              170 |
| San Diego\_CA      |           461 |              175 |
| San Francisco\_CA  |           663 |              336 |
| Savannah\_GA       |           246 |              115 |
| St. Louis\_MO      |          1677 |              905 |
| Stockton\_CA       |           444 |              266 |
| Tampa\_FL          |           208 |               95 |
| Tulsa\_AL          |             1 |                0 |
| Tulsa\_OK          |           583 |              193 |
| Washington\_DC     |          1345 |              589 |

prop.test for Baltimore:

``` r
prop_test_baltimore =
  prop.test(
    homicide_summarize %>% filter(city_state == "Baltimore_MD") %>% pull(unsolved_number),
    homicide_summarize %>% filter(city_state == "Baltimore_MD") %>% pull(total_number)
  )

prop_test_baltimore %>% 
  broom::tidy() %>% 
  select(estimate, conf.low, conf.high) %>% 
  janitor::clean_names() %>% 
  knitr::kable(digit = 3)
```

| estimate | conf\_low | conf\_high |
|---------:|----------:|-----------:|
|    0.646 |     0.628 |      0.663 |

run prop.test for each of the cities:

``` r
prop_test_df = 
  homicide_summarize %>% 
  mutate(
    prop_test = map2(.x = unsolved_number, .y = total_number, ~ prop.test(x = .x, n = .y)),
    prop_test = map(prop_test, broom::tidy)
  ) %>% 
  unnest() %>% 
  select(city_state, total_number, unsolved_number, estimate, conf.low, conf.high) %>% 
  janitor::clean_names()

prop_test_df %>% knitr::kable(digit = 3)
```

| city\_state        | total\_number | unsolved\_number | estimate | conf\_low | conf\_high |
|:-------------------|--------------:|-----------------:|---------:|----------:|-----------:|
| Albuquerque\_NM    |           378 |              146 |    0.386 |     0.337 |      0.438 |
| Atlanta\_GA        |           973 |              373 |    0.383 |     0.353 |      0.415 |
| Baltimore\_MD      |          2827 |             1825 |    0.646 |     0.628 |      0.663 |
| Baton Rouge\_LA    |           424 |              196 |    0.462 |     0.414 |      0.511 |
| Birmingham\_AL     |           800 |              347 |    0.434 |     0.399 |      0.469 |
| Boston\_MA         |           614 |              310 |    0.505 |     0.465 |      0.545 |
| Buffalo\_NY        |           521 |              319 |    0.612 |     0.569 |      0.654 |
| Charlotte\_NC      |           687 |              206 |    0.300 |     0.266 |      0.336 |
| Chicago\_IL        |          5535 |             4073 |    0.736 |     0.724 |      0.747 |
| Cincinnati\_OH     |           694 |              309 |    0.445 |     0.408 |      0.483 |
| Columbus\_OH       |          1084 |              575 |    0.530 |     0.500 |      0.560 |
| Dallas\_TX         |          1567 |              754 |    0.481 |     0.456 |      0.506 |
| Denver\_CO         |           312 |              169 |    0.542 |     0.485 |      0.598 |
| Detroit\_MI        |          2519 |             1482 |    0.588 |     0.569 |      0.608 |
| Durham\_NC         |           276 |              101 |    0.366 |     0.310 |      0.426 |
| Fort Worth\_TX     |           549 |              255 |    0.464 |     0.422 |      0.507 |
| Fresno\_CA         |           487 |              169 |    0.347 |     0.305 |      0.391 |
| Houston\_TX        |          2942 |             1493 |    0.507 |     0.489 |      0.526 |
| Indianapolis\_IN   |          1322 |              594 |    0.449 |     0.422 |      0.477 |
| Jacksonville\_FL   |          1168 |              597 |    0.511 |     0.482 |      0.540 |
| Kansas City\_MO    |          1190 |              486 |    0.408 |     0.380 |      0.437 |
| Las Vegas\_NV      |          1381 |              572 |    0.414 |     0.388 |      0.441 |
| Long Beach\_CA     |           378 |              156 |    0.413 |     0.363 |      0.464 |
| Los Angeles\_CA    |          2257 |             1106 |    0.490 |     0.469 |      0.511 |
| Louisville\_KY     |           576 |              261 |    0.453 |     0.412 |      0.495 |
| Memphis\_TN        |          1514 |              483 |    0.319 |     0.296 |      0.343 |
| Miami\_FL          |           744 |              450 |    0.605 |     0.569 |      0.640 |
| Milwaukee\_wI      |          1115 |              403 |    0.361 |     0.333 |      0.391 |
| Minneapolis\_MN    |           366 |              187 |    0.511 |     0.459 |      0.563 |
| Nashville\_TN      |           767 |              278 |    0.362 |     0.329 |      0.398 |
| New Orleans\_LA    |          1434 |              930 |    0.649 |     0.623 |      0.673 |
| New York\_NY       |           627 |              243 |    0.388 |     0.349 |      0.427 |
| Oakland\_CA        |           947 |              508 |    0.536 |     0.504 |      0.569 |
| Oklahoma City\_OK  |           672 |              326 |    0.485 |     0.447 |      0.524 |
| Omaha\_NE          |           409 |              169 |    0.413 |     0.365 |      0.463 |
| Philadelphia\_PA   |          3037 |             1360 |    0.448 |     0.430 |      0.466 |
| Phoenix\_AZ        |           914 |              504 |    0.551 |     0.518 |      0.584 |
| Pittsburgh\_PA     |           631 |              337 |    0.534 |     0.494 |      0.573 |
| Richmond\_VA       |           429 |              113 |    0.263 |     0.223 |      0.308 |
| Sacramento\_CA     |           376 |              139 |    0.370 |     0.321 |      0.421 |
| San Antonio\_TX    |           833 |              357 |    0.429 |     0.395 |      0.463 |
| San Bernardino\_CA |           275 |              170 |    0.618 |     0.558 |      0.675 |
| San Diego\_CA      |           461 |              175 |    0.380 |     0.335 |      0.426 |
| San Francisco\_CA  |           663 |              336 |    0.507 |     0.468 |      0.545 |
| Savannah\_GA       |           246 |              115 |    0.467 |     0.404 |      0.532 |
| St. Louis\_MO      |          1677 |              905 |    0.540 |     0.515 |      0.564 |
| Stockton\_CA       |           444 |              266 |    0.599 |     0.552 |      0.645 |
| Tampa\_FL          |           208 |               95 |    0.457 |     0.388 |      0.527 |
| Tulsa\_AL          |             1 |                0 |    0.000 |     0.000 |      0.945 |
| Tulsa\_OK          |           583 |              193 |    0.331 |     0.293 |      0.371 |
| Washington\_DC     |          1345 |              589 |    0.438 |     0.411 |      0.465 |

Create a plot that shows the estimates and CIs for each city:

``` r
prop_test_df %>% 
  mutate(
    city_state = fct_reorder(city_state, estimate)
  ) %>% 
  ggplot(aes(y = city_state, x = estimate, fill = city_state)) +
  geom_col() +
  geom_errorbar(aes(xmin = conf_low, xmax = conf_high)) +
  theme(legend.position = "none") +
  labs(
    title = "Estimated unsolved proportion plot",
    x = "estimated unsolved proportion",
    y = "city"
  )
```

![](p8105_hw5_jz3425_files/figure-gfm/unnamed-chunk-5-1.png)<!-- -->
